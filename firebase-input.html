<link rel="import" href="../polymer/polymer.html">
<link rel="import" href="../firebase-element/firebase-document.html">
<link rel="import" href="../paper-input/paper-input.html">
<link rel="import" href="../paper-button/paper-button.html">

<!--
# firebase-input

`<firebase-input>` wraps a Firebase document value in a paper-input for editing

[API Docs and Demo](https://heka-house-firebase-input-demo.firebaseapp.com/)

[Source](http://github.com/hekahouse/firebase-input/)

The label is set to the path of the value.

## Install

    bower install --save HekaHouse/firebase-input

## Example
    <template is="dom-repeat" items="{{LEAVES}}" as="LEAF">
      <firebase-input
        firebase-root="https://YOUR-FIREBASE.firebaseio.com/COLLECTION/ITEM/LEAF"
        label="leaf"></firebase-input>
    </template>

In the above examplle replace YOUR-FIREBASE, COLLECTION, ITEM and LEAF-PATH with appropriate values from your Firebase.

LEAVES are a collection of the full paths to Firebase values ie:

    https://YOUR-FIREBASE.firebaseio.com/users/name/first-name

## Note

The Firebase document is initiaized once the firebase-root is provided.

## Dependencies

Element dependencies are managed via [Bower](http://bower.io/). You can
install that via:

    npm install -g bower

Then, go ahead and download the element's dependencies:

    bower install

firebase-input depends only on standard polymer elements from Google

## Related

firebase-input is designed for use inside of [firebase-card](https://heka-house-firebase-card-demo.firebaseapp.com)

@group HekaHouse
@element firebase-input
@demo demo/index.html

-->

<dom-module id="firebase-input">
  <template>
  <style>
    :host {
      display: block;
    }
  </style>
    <firebase-document
      id="firebaseDocument"
      data="{{leafDocument}}"></firebase-document>
    <paper-input id="fireInput" label="{{label}}" on-change="_applyChange"></paper-input>
  </template>
</dom-module>
<script>
  Polymer({
    is: 'firebase-input',
    properties: {
      /**
      * URL to firebase document
      */
      firebaseRoot: {
        type: String,
        notify: true,
        observer: '_applyLocation'
      },
      /**
      * label to apply to paper-input, corresponds to path applied to
      * firebaseRoot
      */
      label: {
        type: String,
        notify: true
      },
      /**
      * value from assigned firebase-document
      */
      leafDocument: {
        type: Object,
        notify: true,
        observer: '_applyDocument'
      }
    },
    /**
    * Set Firebase Document location
    * observer for firebaseRoot
    */
    _applyLocation: function(firebaseRoot) {
      if (firebaseRoot) {
        this.$.firebaseDocument.location=this.firebaseRoot;
      }
    },
    /**
    * Set value for paper-input
    * no binding is used to avoid triggering errors with firebase-document
    */
    _applyDocument: function(leafDocument) {
      if (leafDocument) {
        this.$.fireInput.value=leafDocument;
      }
    },
    /**
    * Listen for changes to paper-input value
    * update firebase-document via Firebase API
    */
    _applyChange: function(leafDocument) {
      var ref = new Firebase(this.firebaseRoot);
      ref.set(this.$.fireInput.value);
    }

  });
</script>
